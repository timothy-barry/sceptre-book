[
  {
    "objectID": "run-power-check-and-discovery-analysis.html#run-power-check",
    "href": "run-power-check-and-discovery-analysis.html#run-power-check",
    "title": "\n6  Run power check and discovery analysis\n",
    "section": "\n6.1 Run power check",
    "text": "6.1 Run power check\nWe run the power check by calling the function run_power_check(), which takes the arguments sceptre_object (required), output_amount (optional), print_progress (optional), and parallel (optional). output_amount controls the amount of information that run_power_check() returns; see Section 5.5 of Run calibration check for more information about this argument. print_progress and parallel are logical values indicating whether to print progress updates and run the computation in parallel, respectively. We run the power check on the low-MOI CRISPRko data.\n\nsceptre_object_lowmoi &lt;- run_power_check(sceptre_object = sceptre_object_lowmoi,\n                                         parallel = TRUE)\n\nWe call plot() on the resulting sceptre_object to visualize the outcome of the power check.\n\nplot(sceptre_object_lowmoi)\n\n\n\n\n\nPower check results on the low-MOI CRISPRko data.\n\n\n\nWe described how to interpret this plot in Section 6 of The whole game. Briefly, each point represents a pair, and the vertical position of a given point indicates the p-value of the corresponding pair. Points in the left (resp., right) column are positive control (resp, negative control) pairs. The positive control p-values should be generally smaller (i.e., more significant) than the negative control p-values."
  },
  {
    "objectID": "run-power-check-and-discovery-analysis.html#run-discovery-analysis",
    "href": "run-power-check-and-discovery-analysis.html#run-discovery-analysis",
    "title": "\n6  Run power check and discovery analysis\n",
    "section": "\n6.2 Run discovery analysis",
    "text": "6.2 Run discovery analysis\nWe run the discovery analysis by calling the function run_discovery_analysis(), which takes the same arguments as run_power_check(). We illustrate this function on the low-MOI CRISPRko data.\n\nsceptre_object_lowmoi &lt;- run_discovery_analysis(sceptre_object = sceptre_object_lowmoi,\n                                                parallel = TRUE)\n\nWe can visualize the outcome of the discovery analysis by calling plot() on the resulting sceptre_object.\n\nplot(sceptre_object_lowmoi)\n\n\n\n\n\nDiscovery analysis results on the low-MOI CRISPRko data.\n\n\n\nWe described how to interpret this plot in Section 7 of The whole game. Briefly, the top left (resp. right) panel is a QQ plot of the negative control p-values and the discovery p-values plotted on an untransformed (resp., transformed) scale. The bottom left panel plots the p-value of each discovery pair against its log-2-fold-change. Finally, the bottom right panel displays the number of discoveries that sceptre makes on the discovery set (after applying the multiplicity correction)."
  },
  {
    "objectID": "run-power-check-and-discovery-analysis.html#inspecting-the-results",
    "href": "run-power-check-and-discovery-analysis.html#inspecting-the-results",
    "title": "\n6  Run power check and discovery analysis\n",
    "section": "\n6.3 Inspecting the results",
    "text": "6.3 Inspecting the results\nWe can obtain a data frame containing the results by calling get_result() on the sceptre_object, setting the parameter analysis to the name of the function whose results we are querying. For example, we can obtain the discovery results as follows.\n\ndiscovery_result &lt;- get_result(sceptre_object = sceptre_object_lowmoi,\n                               analysis = \"run_discovery_analysis\")\nhead(discovery_result)\n\n   response_id grna_target n_nonzero_trt n_nonzero_cntrl pass_qc       p_value\n1:        JAK2       STAT1           112            1557    TRUE 1.000000e-250\n2:       PSMB9      IFNGR1           873            1801    TRUE 3.381199e-155\n3:       PSMB9        JAK2           706            1801    TRUE 4.456437e-145\n4:       STAT1      IFNGR2           821            1819    TRUE 3.231543e-127\n5:       STAT1      IFNGR1           898            1819    TRUE 3.361381e-127\n6:       STAT1        JAK2           714            1819    TRUE 1.404004e-122\n   log_2_fold_change significant\n1:        -1.3840723        TRUE\n2:        -0.8561766        TRUE\n3:        -0.9410000        TRUE\n4:        -0.6669393        TRUE\n5:        -0.6371647        TRUE\n6:        -0.7134929        TRUE\n\n\nThe data frame discovery_result contains the columns response_id, grna_target, n_nonzero_trt, n_nonzero_cntrl, pass_qc, p_value, log_2_fold_change, and significant; see Section 5.2 of Run calibration check for a description of these columns. The rows are ordered according to p_value. Pairs called as significant are stored in the top rows of the data frame; pairs not called as significant are stored in the middle rows; and pairs filtered out by pairwise QC are stored in the bottom rows. (The latter pairs have a value of NA in the p_value, log_2_fold_change, and significant columns.)\nThe format of the result data frame changes when we use the “singleton” gRNA integration strategy instead of the default “union” strategy. To illustrate, we again analyze the low-MOI CRISPRko data, this time setting grna_integration_strategy to \"singleton\" in set_analysis_parameters(). We then call assign_grnas(), run_qc(), and run_discovery_analysis().\n\n sceptre_object_lowmoi &lt;- sceptre_object_lowmoi |&gt;\n  set_analysis_parameters(discovery_pairs = discovery_pairs_lowmoi,\n                          positive_control_pairs = positive_control_pairs_lowmoi,\n                          grna_integration_strategy = \"singleton\") |&gt;\n  assign_grnas() |&gt; run_qc(p_mito_threshold = 0.075) |&gt;\n  run_discovery_analysis(parallel = TRUE)\n\nGenerating permutation resamples. ✓\nRunning discovery_analysis in parallel. Change directories to /var/folders/h6/pt59hmwd7rqb3jqfzwh0hlth0000gn/T//RtmpkgaHcI/sceptre_logs/ and view the files discovery_analysis_*.out for progress updates.\n ✓\n\n\nThe result data frame obtained via get_result() contains the additional column grna_id. Each row of this data frame corresponds to an individual gRNA-response pair (as opposed to target-response pair) that we have tested for association.\n\ndiscovery_result &lt;- get_result(sceptre_object = sceptre_object_lowmoi,\n                               analysis = \"run_discovery_analysis\")\nhead(discovery_result)\n\n   response_id  grna_id grna_target n_nonzero_trt n_nonzero_cntrl pass_qc\n1:       PSMB9 IFNGR2g1      IFNGR2           384            1801    TRUE\n2:       STAT1 IFNGR2g1      IFNGR2           407            1819    TRUE\n3:       STAT1 IFNGR1g3      IFNGR1           317            1819    TRUE\n4:       PSMB9 IFNGR1g3      IFNGR1           304            1801    TRUE\n5:      UBE2L6 IFNGR2g1      IFNGR2           375            1794    TRUE\n6:        JAK2 IFNGR2g1      IFNGR2           176            1557    TRUE\n         p_value log_2_fold_change significant\n1: 3.610750e-106        -1.2076649        TRUE\n2:  1.525194e-97        -0.9332334        TRUE\n3:  7.272333e-92        -1.0104953        TRUE\n4:  7.077892e-85        -1.2386121        TRUE\n5:  4.216879e-80        -0.8712660        TRUE\n6:  1.992249e-70        -1.5816584        TRUE\n\n\nWe can filter on a given target-response pair to view the p-value for the test of association between each individual gRNA targeting the given target and the given response. For example, we subset the result data frame to filter for rows containing the response ID \"PSMB9\" and the gRNA target \"IFNGR2\".\n\ndiscovery_result |&gt;\n  dplyr::filter(response_id == \"PSMB9\", grna_target == \"IFNGR2\") |&gt;\n  dplyr::select(response_id, grna_id, grna_target, p_value, significant)\n\n   response_id  grna_id grna_target       p_value significant\n1:       PSMB9 IFNGR2g1      IFNGR2 3.610750e-106        TRUE\n2:       PSMB9 IFNGR2g2      IFNGR2  9.280090e-50        TRUE\n3:       PSMB9 IFNGR2g3      IFNGR2  1.424416e-17        TRUE\n4:       PSMB9 IFNGR2g4      IFNGR2  3.200000e-02       FALSE"
  },
  {
    "objectID": "glossary.html#assay-design",
    "href": "glossary.html#assay-design",
    "title": "Appendix A — Glossary",
    "section": "\nA.1 Assay design",
    "text": "A.1 Assay design\nThe following terms describe the design of pooled single-cell CRISPR screen assays, where the goal is to perturb a set of genomic targets and measure the effects of these perturbations on a set of molecular phenotypes.\n\nPerturbation: A change to the genome of a cell carried out by the CRISPR-Cas9 system or one of its variants. Common perturbations include CRISPRko (knockout via nuclease-active Cas9), CRISPRi (inactivation via dCas9 tethered to a repressive domain), CRISPRa (activation via dCas9 tethered to an activating domain).\nGuide RNA (gRNA): An RNA guiding the Cas9 (or one of its variants) to its target in order to perturb it.\nTarget: The genomic element targeted by a gRNA. Possible targets include gene transcription start sites and noncoding elements such as enhancers, silencers, and noncoding GWAS variants.\nTargeting gRNA: A gRNA that is intended to perturb a genomic target.\nNon-targeting gRNA: A gRNA whose barcode sequence either does not map anywhere in the genome or maps to a location whose perturbation is known to have no effect. Non-targeting gRNAs serve as negative controls.\nResponse: A molecular phenotype readout in the single-cell CRISPR screen, whose response to CRISPR perturbation is of interest. Possible responses include genes, proteins, and chromatin-derived features.\nMultiplicity of infection (MOI): The MOI of a screen can be categorized as low or high and also can also be numerically quantified. A high-MOI (respectively, low-MOI) dataset is one in which the experimenter has aimed to insert multiple gRNAs (respectively, a single gRNA) into each cell. Quantitatively, the MOI of a screen is the average number of gRNAs delivered per cell. For example, an MOI of 10 means that on average each cell receives 10 gRNAs."
  },
  {
    "objectID": "glossary.html#hypothesis-construction",
    "href": "glossary.html#hypothesis-construction",
    "title": "Appendix A — Glossary",
    "section": "\nA.2 Hypothesis construction",
    "text": "A.2 Hypothesis construction\nThe main statistical task in single-cell CRISPR screen analysis is to test hypotheses of the form: Does perturbing a target impact a response? We use the following terminology to describe the construction of such hypotheses.\n\n\nTarget-response pair: A pair consisting of a target and a response. For example, a target-response pair could be a specific enhancer and a specific gene. Each target-response pair corresponds to a hypothesis to be tested: Does perturbing the target impact the response?\nNegative control pair: A target-response pair in which the target is a non-targeting gRNA. Negative control pairs are used to assess the calibration of a statistical analysis method.\nPositive control pair: A target-response pair in which the target is a targeting gRNA known to have an effect on the response. For example, a positive control pair may consist of a gRNA targeting a transcription start site coupled to the gene regulated by that transcription start site. Positive control pairs are used to assess the power of a statistical analysis method.\nDiscovery pair: A target-response pair in which the target is a targeting gRNA whose effect on the response is unknown. The main goal of a single-cell CRISPR screen is to search for new associations among discovery pairs.\nCis pair: A target-response pair in which the target and response are located in close proximity on the same chromosome. For example, a cis pair may consist of a gRNA targeting an enhancer and a gene whose transcription start site is located a few kilobases away.\nTrans pair: A target-response pair for which the target and response are not necessarily located in close proximity or on the same chromosome as one another.\nPairwise quality control: A procedure for filtering out target-response pairs whose data are too sparse to be analyzed reliably. Pairwise quality control is based on metrics that take into account the sparsity of the response variable and the number of cells in which the target has been perturbed.\nCellwise quality control: A procedure for filtering out cells whose data suggest aberrations in the library preparation or sequencing processes. This common step in single-cell sequencing analyses (not just CRISPR screens) is based on metrics like the total number of UMIs detected in a cell and the percentage of UMIs mapping to mitochondrial genes."
  },
  {
    "objectID": "glossary.html#statistical-methodologies",
    "href": "glossary.html#statistical-methodologies",
    "title": "Appendix A — Glossary",
    "section": "\nA.3 Statistical methodologies",
    "text": "A.3 Statistical methodologies\nThe following terms describe the statistical methodologies used in single-cell CRISPR screen analysis. Their main focus is to compare the responses of cells that have been perturbed with those that have not.\n\nTreatment group: The group of cells for which a given target has been perturbed.\nControl group: A group of cells for which a given target has not been perturbed, which serve as a point of comparison to the treatment group. The control group is typically either the non-targeting set or the complement set; see below.\nNon-targeting set: The set of cells to which only a non-targeting gRNA has been delivered. This is the most common control group for low-MOI screens.\nComplement set: The set of cells for which a given target has not been perturbed (but for which other targets may have been perturbed). This is the most common control group for high-MOI screens.\nCovariate: An unwanted source of variation that may affect (the measurement of) the response and/or the perturbations in a cell. Covariates can be technical (relating to the library preparation or sequencing processes) or biological (relating to the cell itself). Common technical covariates include the sequencing depth of a cell and the number of gRNAs inserted into a cell; common biological covariates include cell cycle stage and cell type.\n\nFormula object: A formula object specifies the covariates and their transformations that should be used adjusted for in a statistical analysis method. An example of a formula object is\n\n~ log(response_n_nonzero) + log(response_n_umis) + response_p_mito + batch\n\n\nResampling: A computer-based procedure for estimating the null distribution of a test statistic that circumvents the use of asymptotic approximations (which may not hold for sparse single-cell data). Resampling procedures include the permutation test and the conditional randomization test (see below).\nPermutation test: A resampling procedure for estimating the null distribution of a test statistic based on permuting the treatment and control labels of the cells and recomputing the test statistic.\nConditional randomization test: A resampling procedure for estimating the null distribution of a test statistic based on randomly reassigning the treatment and control labels of the cells based on their covariate values.\nMultiple testing procedure: A procedure that inputs a list of p-values for a set of target-response pairs and outputs a subset of these pairs that are deemed to have a statistically significant relationship. The most common multiple testing procedure is the Benjamini-Hochberg procedure, which aims to control the false discovery rate (see below) at a prespecified level, such as 0.1.\nSkew-normal distribution: A generalization of the Gaussian distribution that has three parameters: a mean parameter, a variance parameter, and a skew parameter. The skew parameter controls the extent to which the distribution is asymmetric relative to a Gaussian distribution."
  },
  {
    "objectID": "glossary.html#statistical-properties-and-their-assessment",
    "href": "glossary.html#statistical-properties-and-their-assessment",
    "title": "Appendix A — Glossary",
    "section": "\nA.4 Statistical properties and their assessment",
    "text": "A.4 Statistical properties and their assessment\nThe following terms describe the statistical properties of an analysis method (whether sceptre or otherwise) and how they are assessed. These statistical properties are essential to making reliable conclusions based on single-cell CRISPR screen data.\n\nFalse discovery rate (FDR): The proportion of the statistically significant target-response pairs returned by a multiple testing procedure that are false positives. A high FDR indicates significant contamination by false positives, making the underlying statistical methodology unreliable.\nCalibration: The extent to which the p-values returned by a statistical analysis method are uniformly distributed under the null hypothesis. A well-calibrated method will return p-values that, when processed by a multiple testing procedure, will result in an FDR close to the desired level.\nPower: Otherwise known as sensitivity, power is the ability of a statistical analysis method to detect true associations. For example, a method has high power if it can detect many of the true associations with high probability.\nCalibration check: A procedure for assessing the calibration of a statistical analysis method. A calibration check typically proceeds by applying the method to a set of negative control pairs and then checking the extent to which the resulting p-values are uniformly distributed.\nPower check: A procedure for assessing the power of a statistical analysis method. A power check typically proceeds by applying the method to a set of positive control pairs and then checking the extent to which the resulting p-values are small.\nQQ plot: A plot used to compare the set of p-values outputted by a method to the uniform distribution, which is the null distribution of a well-calibrated method. A QQ plot of the p-values returned by a method for a set of negative control pairs therefore can be used to check the method’s calibration. Visually, a well-calibrated method will produce a QQ plot that is close to the diagonal."
  },
  {
    "objectID": "multiple-analyses.html",
    "href": "multiple-analyses.html",
    "title": "Appendix B — Running multiple analyses",
    "section": "",
    "text": "In this chapter, we propose recommended strategies for carrying out multiple SCEPTRE analyses, such as\n\nrunning cis and trans analyses;\nrunning analyses with gRNAs grouped based on target and with singleton gRNAs."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Hands-On Single-Cell CRISPR Screen Analysis",
    "section": "",
    "text": "Welcome\nSingle-cell CRISPR screens (e.g., perturb-seq) combine CRISPR genome engineering and single-cell sequencing to survey the effects of genetic perturbations on individual cells. Single-cell CRISPR screens pose enormous potential for unraveling mechanisms underlying disease and accelerating drug discovery. However, the analysis of these screens presents considerable statistical and computational challenges. Hands-On Single-Cell CRISPR Screen Analysis is a step-by-step guide to carrying out statistically rigorous and computationally efficient single-cell CRISPR screen data analysis using the sceptre R package. sceptre was developed by Timothy Barry, Joseph Deutsch, and Eugene Katsevich.\nsceptre is compatible with a broad range of single-cell CRISPR screen experimental designs. In particular, datasets can vary along the following axes: multiplicity of infection (low or high), genomic element targeted (gene or noncoding regulatory element), CRISPR modality (CRISPRko, CRISPRi, CRISPRa, or CRISPR prime or base editing), and molecular readout (gene expression, protein expression, or chromatin accessibility). This book uses two real datasets to illustrate use of sceptre: a high-MOI CRISPRi screen of noncoding regulatory elements and a low-MOI CRISPRko screen of gene transcription start sites.\n\n\nNavigating this book\nUsers should start by reading The whole game, which provides a high-level overview of sceptre. Users who wish to learn more about individual steps of the sceptre pipeline should read the subsequent chapters in order. Finally, we recommend that users consult the Glossary throughout to keep track of the terminology used in this book.\n\n\nAcknowledgments\nWe gratefully acknowledge Kathryn Roeder, John Morris, Kaishu Mason, Xuran Wang, and Ziang Niu for contributing to the research and development underlying sceptre. We additionally thank the many sceptre users who have provided and continue to provide valuable feedback on the package."
  }
]